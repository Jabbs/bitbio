<%= form_for @user, :html=>{:multipart => true } do |f| %>
  <div class="row" style="margin-top: 10px;">
    <div class="span9">
      <%= render 'shared/error_messages', object: f.object %>
      <% if action_name == "edit" %>
        <h2 style="margin-top: 5px;">Editing Account</h2>
      <% else %>
        <h2 style="margin-top: 5px;">Join the Bitbio science community!</h2>
      <% end %>
      <hr style="margin-top: 5px;">
      
      <% if action_name == "edit" || action_name == "update" %>
        
        <div class="row" style="margin-bottom: 20px;">
          <div class="span2">
             <label>Profile Picture:</label>
           </div>
           <div class="span6">
            <%= f.fields_for :attachments do |attch| %>
              <% attch.object.new_record? ? new_attch = "new_attch" : new_attch = '' %>
              <fieldset class="<%= new_attch %>">
                 <% if attch.object.new_record? %>
                   <%= attch.file_field :image %>
                 <% else %>
                   <%= image_tag(attch.object.image.url).to_s %>
                   <%= f.hidden_field :_destroy %>
                   <%= link_to "<i class='icon-trash'></i> remove".html_safe, '#', class: 'remove_fields', 
                       style: 'margin-left: 5px;' %>
                 <% end %>
              </fieldset>
            <% end %>
             <p style="margin-top: 5px;"><small>Accepted file formats: jpg jpeg gif png.</small></p>
           </div>
        </div>
      <hr>
      <% end %>
      <div class="row">
        <div class="span2">
  				<label><i class="icon-asterisk red"></i> Name:</label>
  			</div>
  			<div class="span6">
  		    <%= f.text_field :first_name, class: "span2", placeholder: "First" %> 
  				<%= f.text_field :last_name, class: "span2", placeholder: "Last" %>
  			</div>
      </div>

      <div class="row">
        <div class="span2">
  				<label><i class="icon-asterisk red"></i> Email:</label>
  			</div>
  			<div class="span6">
  		    <%= f.text_field :email, class: "span3", placeholder: "Email", style: 'width: 273px' %> 
  			</div>
      </div>
      <% if action_name == "edit" || action_name == "update" %>
      <div class="row">
        <div class="span2">
  				<label>Phone:</label>
  			</div>
  			<div class="span6">
  		    <%= f.text_field :phone, class: "span3", placeholder: "Phone", style: 'width: 273px' %> 
  			</div>
      </div>
      <hr>
      <% end %>
      <div class="row">
        <div class="span2">
  				<label><i class="icon-asterisk red"></i> Organization:</label>
  			</div>
  			<div class="span6">
  		  
  		    <input style="width: 373px;" id="user_organization" name="user[organization]" 
          placeholder="Organization name" size="30" type="text" 
          data-provide="typeahead" data-source="<%= Facility.scoped.pluck(:name).uniq.sort %>"
          autocomplete="off" 
          <% unless @user.new_record? %>
            value="<%= @user.organization %>"
          <% end %>
           />
  		    
  			</div>
      </div>
      <% if action_name == "edit" || action_name == "update"  %>
      <div class="row">
        <div class="span2">
  				<label>Bio:</label>
  			</div>
  			<div class="span6">
  		    <%= f.text_area :bio, class: 'span6', rows: 7, 
  		        placeholder: "Please describe your scientific background." %> 
  			</div>
      </div>
      <hr>
      <% end %>
      <div class="row">
        <div class="span2">
  				<label><i class="icon-asterisk red"></i> Country:</label>
  			</div>
  			<div class="span6">
  			  <% request.location.country == "United States" ? country = "United States of America" : country = "" %>
  			  <% if action_name == "edit" || action_name == "update"  %>
    			  <%= f.select :country, Ravibhim::Continents::COUNTRIES, 
    		      { prompt: "--select--" }, style: 'width: 283px' %>
  		    <% else %>
    		    <%= f.select :country, Ravibhim::Continents::COUNTRIES, 
    		      { prompt: "--select--", selected: country }, style: 'width: 283px' %>
  		    <% end %>
  			</div>
      </div>
      <% if @user.new_record? %>
        <hr>
        <div class="row">
    			<div class="span2">
    				<label class="inline"><i class="icon-asterisk red"></i> Password:</label>
    			</div>
    			<div class="span2">
    				 <%= f.password_field :password, class: 'span2' %>
    			</div>
    		</div>
      <% end %>
      <hr>
      <div class="row">
        <div class="span9">
          <% if action_name == 'edit' || action_name == 'update' %>
            <%= f.submit "Update Account", class: "btn", disable_with: 'Submitting...' %> |
            <%= link_to "cancel", @user%>
          <% else %>
            <%= f.submit "Create Account", class: "btn", disable_with: 'Submitting...' %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
  
<% end %>
